!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("plupload-es6")):"function"==typeof define&&define.amd?define(["plupload-es6"],t):"object"==typeof exports?exports.Qiniu=t(require("plupload-es6")):e.Qiniu=t(e["plupload-es6"])}(this,function(__WEBPACK_EXTERNAL_MODULE_69__){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=70)}([function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){var n=r(48),o=r(14);e.exports=function(e){return n(o(e))}},function(e,t,r){e.exports=!r(8)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,r){var n=r(5),o=r(11);e.exports=r(3)?function(e,t,r){return n.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){var n=r(7),o=r(29),i=r(23),a=Object.defineProperty;t.f=r(3)?Object.defineProperty:function(e,t,r){if(n(e),t=i(t,!0),n(r),o)try{return a(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){var n=r(21)("wks"),o=r(12),i=r(0).Symbol,a="function"==typeof i;(e.exports=function(e){return n[e]||(n[e]=a&&i[e]||(a?i:o)("Symbol."+e))}).store=n},function(e,t,r){var n=r(9);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,r){var n=r(34),o=r(15);e.exports=Object.keys||function(e){return n(e,o)}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t){var r=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){e.exports={}},function(e,t){e.exports=!0},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,r){var n=r(5).f,o=r(1),i=r(6)("toStringTag");e.exports=function(e,t,r){e&&!o(e=r?e:e.prototype,i)&&n(e,i,{configurable:!0,value:t})}},function(e,t,r){var n=r(21)("keys"),o=r(12);e.exports=function(e){return n[e]||(n[e]=o(e))}},function(e,t,r){var n=r(0),o=n["__core-js_shared__"]||(n["__core-js_shared__"]={});e.exports=function(e){return o[e]||(o[e]={})}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t,r){var n=r(9);e.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!n(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){var n=r(0),o=r(13),i=r(17),a=r(25),u=r(5).f;e.exports=function(e){var t=o.Symbol||(o.Symbol=i?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||u(t,e,{value:a.f(e)})}},function(e,t,r){t.f=r(6)},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,r){var n=r(9),o=r(0).document,i=n(o)&&n(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t,r){var n=r(0),o=r(13),i=r(45),a=r(4),u=function(e,t,r){var s,c,f,l=e&u.F,p=e&u.G,d=e&u.S,g=e&u.P,h=e&u.B,v=e&u.W,m=p?o:o[t]||(o[t]={}),y=m.prototype,b=p?n:d?n[t]:(n[t]||{}).prototype;p&&(r=t);for(s in r)(c=!l&&b&&void 0!==b[s])&&s in m||(f=c?b[s]:r[s],m[s]=p&&"function"!=typeof b[s]?r[s]:h&&c?i(f,n):v&&b[s]==f?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(f):g&&"function"==typeof f?i(Function.call,f):f,g&&((m.virtual||(m.virtual={}))[s]=f,e&u.R&&y&&!y[s]&&a(y,s,f)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t,r){e.exports=!r(3)&&!r(8)(function(){return 7!=Object.defineProperty(r(27)("div"),"a",{get:function(){return 7}}).a})},function(e,t,r){"use strict";var n=r(17),o=r(28),i=r(35),a=r(4),u=r(1),s=r(16),c=r(50),f=r(19),l=r(57),p=r(6)("iterator"),d=!([].keys&&"next"in[].keys()),g=function(){return this};e.exports=function(e,t,r,h,v,m,y){c(r,t,h);var b,_,x,k=function(e){if(!d&&e in E)return E[e];switch(e){case"keys":return function(){return new r(this,e)};case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},w=t+" Iterator",O="values"==v,S=!1,E=e.prototype,U=E[p]||E["@@iterator"]||v&&E[v],T=U||k(v),j=v?O?k("entries"):T:void 0,R="Array"==t?E.entries||U:U;if(R&&(x=l(R.call(new e)))!==Object.prototype&&(f(x,w,!0),n||u(x,p)||a(x,p,g)),O&&U&&"values"!==U.name&&(S=!0,T=function(){return U.call(this)}),n&&!y||!d&&!S&&E[p]||a(E,p,T),s[t]=T,s[w]=g,v)if(b={values:O?T:k("values"),keys:m?T:k("keys"),entries:j},y)for(_ in b)_ in E||i(E,_,b[_]);else o(o.P+o.F*(d||S),t,b);return b}},function(e,t,r){var n=r(7),o=r(54),i=r(15),a=r(20)("IE_PROTO"),u=function(){},s=function(){var e,t=r(27)("iframe"),n=i.length;for(t.style.display="none",r(47).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object</script>"),e.close(),s=e.F;n--;)delete s.prototype[i[n]];return s()};e.exports=Object.create||function(e,t){var r;return null!==e?(u.prototype=n(e),r=new u,u.prototype=null,r[a]=e):r=s(),void 0===t?r:o(r,t)}},function(e,t,r){var n=r(34),o=r(15).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,o)}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){var n=r(1),o=r(2),i=r(44)(!1),a=r(20)("IE_PROTO");e.exports=function(e,t){var r,u=o(e),s=0,c=[];for(r in u)r!=a&&n(u,r)&&c.push(r);for(;t.length>s;)n(u,r=t[s++])&&(~i(c,r)||c.push(r));return c}},function(e,t,r){e.exports=r(4)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function createCookie(e,t,r){var n=new Date;n.setTime(n.getTime()+24*r*60*60*1e3);var o="; expires="+n.toGMTString();document.cookie=e+"="+t+o+"; path=/"}function readCookie(e){for(var t=e+"=",r=document.cookie.split(";"),n=0,o=r.length;n<o;n++){for(var i=r[n];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return null}function QiniuJsSDK(){function log(e,t){for(var r="[qiniu-js-sdk]["+e+"]",n=r,o=0;o<t.length;o++)"string"==typeof t[o]?n+=" "+t[o]:n+=" "+that.stringifyJSON(t[o]);that.detectIEVersion()||t.unshift(r),document.getElementById("qiniu-js-sdk-log")&&(document.getElementById("qiniu-js-sdk-log").innerHTML+="<p>"+n+"</p>")}function makeLogFunc(e){var t=e.toLowerCase();logger[t]=function(){if(window.console&&window.console.log&&logger.level>=logger[e]){var r=Array.prototype.slice.call(arguments);log(t,r)}}}var that=this;this.detectIEVersion=function(){for(var e=4,t=document.createElement("div"),r=t.getElementsByTagName("i");t.innerHTML="<!--[if gt IE "+e+"]><i></i><![endif]-->",r[0];)e++;return e>4&&e};var logger={MUTE:0,FATA:1,ERROR:2,WARN:3,INFO:4,DEBUG:5,TRACE:6,level:0};for(var property in logger)logger.hasOwnProperty(property)&&"number"==typeof logger[property]&&!logger.hasOwnProperty(property.toLowerCase())&&makeLogFunc(property);var qiniuUploadUrl;qiniuUploadUrl="https:"===window.location.protocol?"https://up.qbox.me":"http://upload.qiniu.com";var qiniuUploadUrls=["http://upload.qiniu.com","http://up.qiniu.com"],qiniuUpHosts={http:["http://upload.qiniu.com","http://up.qiniu.com"],https:["https://up.qbox.me"]},changeUrlTimes=0;this.resetUploadUrl=function(){var e="https:"===window.location.protocol?qiniuUpHosts.https:qiniuUpHosts.http,t=changeUrlTimes%e.length;qiniuUploadUrl=e[t],changeUrlTimes++,logger.debug("resetUploadUrl: "+qiniuUploadUrl)},this.isImage=function(e){return e=e.split(/[?#]/)[0],/\.(png|jpg|jpeg|gif|bmp)$/i.test(e)},this.getFileExtension=function(e){var t=e.split(".");return 1===t.length||""===t[0]&&2===t.length?"":t.pop().toLowerCase()},this.utf8_encode=function(e){if(null===e||void 0===e)return"";var t,r,n=e+"",o="",i=0;t=r=0,i=n.length;for(var a=0;a<i;a++){var u=n.charCodeAt(a),s=null;if(u<128)r++;else if(u>127&&u<2048)s=String.fromCharCode(u>>6|192,63&u|128);else if(63488&u^!0)s=String.fromCharCode(u>>12|224,u>>6&63|128,63&u|128);else{if(64512&u^!0)throw new RangeError("Unmatched trail surrogate at "+a);var c=n.charCodeAt(++a);if(64512&c^!0)throw new RangeError("Unmatched lead surrogate at "+(a-1));u=((1023&u)<<10)+(1023&c)+65536,s=String.fromCharCode(u>>18|240,u>>12&63|128,u>>6&63|128,63&u|128)}null!==s&&(r>t&&(o+=n.slice(t,r)),o+=s,t=r=a+1)}return r>t&&(o+=n.slice(t,i)),o},this.base64_decode=function(e){var t,r,n,o,i,a,u,s,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=0,l=0,p=[];if(!e)return e;e+="";do{o=c.indexOf(e.charAt(f++)),i=c.indexOf(e.charAt(f++)),a=c.indexOf(e.charAt(f++)),u=c.indexOf(e.charAt(f++)),s=o<<18|i<<12|a<<6|u,t=s>>16&255,r=s>>8&255,n=255&s,p[l++]=64===a?String.fromCharCode(t):64===u?String.fromCharCode(t,r):String.fromCharCode(t,r,n)}while(f<e.length);return p.join("")},this.base64_encode=function(e){var t,r,n,o,i,a,u,s,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=0,l=0,p="",d=[];if(!e)return e;e=this.utf8_encode(e+"");do{t=e.charCodeAt(f++),r=e.charCodeAt(f++),n=e.charCodeAt(f++),s=t<<16|r<<8|n,o=s>>18&63,i=s>>12&63,a=s>>6&63,u=63&s,d[l++]=c.charAt(o)+c.charAt(i)+c.charAt(a)+c.charAt(u)}while(f<e.length);switch(p=d.join(""),e.length%3){case 1:p=p.slice(0,-2)+"==";break;case 2:p=p.slice(0,-1)+"="}return p},this.URLSafeBase64Encode=function(e){return e=this.base64_encode(e),e.replace(/\//g,"_").replace(/\+/g,"-")},this.URLSafeBase64Decode=function(e){return e=e.replace(/_/g,"/").replace(/-/g,"+"),this.base64_decode(e)},this.createAjax=function(e){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},this.parseJSON=function(data){if(window.JSON&&window.JSON.parse)return window.JSON.parse(data);var rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,text=String(data);return rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),eval("("+text+")")},this.stringifyJSON=function(e){if(window.JSON&&window.JSON.stringify)return window.JSON.stringify(e);switch(void 0===e?"undefined":(0,_typeof3.default)(e)){case"string":return'"'+e.replace(/(["\\])/g,"\\$1")+'"';case"array":return"["+e.map(that.stringifyJSON).join(",")+"]";case"object":if(e instanceof Array){for(var t=[],r=e.length,n=0;n<r;n++)t.push(that.stringifyJSON(e[n]));return"["+t.join(",")+"]"}if(null===e)return"null";var o=[];for(var i in e)e.hasOwnProperty(i)&&o.push(that.stringifyJSON(i)+":"+that.stringifyJSON(e[i]));return"{"+o.join(",")+"}";case"number":return e;case!1:return e;case"boolean":return e}},this.trim=function(e){return null===e?"":e.replace(/^\s+|\s+$/g,"")},this.uploader=function(e){var t=function(e){for(var t=[],r=-1,n=0;n<e.length;n++){var o=e[n];o.indexOf("upload")!==-1&&(r=n),0===o.indexOf("-H")?t.push(o.split(" ")[2]):t.push(o)}if(r!==-1){var i=t[r];t[r]=t[0],t[0]=i}return t},r=function(e){var t=e.split(":"),r=t[0],n=that.parseJSON(that.URLSafeBase64Decode(t[2]));return n.ak=r,n.scope.indexOf(":")>=0?(n.bucket=n.scope.split(":")[0],n.key=n.scope.split(":")[1]):n.bucket=n.scope,n},n=function(n){var o=r(n),i=window.location.protocol+"//uc.qbox.me/v1/query?ak="+o.ak+"&bucket="+o.bucket;logger.debug("putPolicy: ",o),logger.debug("get uphosts from: ",i);var a,u=that.detectIEVersion();u&&u<=9?(a=new moxie.xhr.XMLHttpRequest,moxie.core.utils.Env.swf_url=e.flash_swf_url):a=that.createAjax(),a.open("GET",i,!1);var s=function(){if(logger.debug("ajax.readyState: ",a.readyState),4===a.readyState)if(logger.debug("ajax.status: ",a.status),a.status<400){var e=that.parseJSON(a.responseText);qiniuUpHosts.http=t(e.http.up),qiniuUpHosts.https=t(e.https.up),logger.debug("get new uphosts: ",qiniuUpHosts),that.resetUploadUrl()}else logger.error("get uphosts error: ",a.responseText)};u&&u<=9?a.bind("readystatechange",s):a.onreadystatechange=s,a.send()},o=function(t){return!that.token||e.uptoken_url&&that.tokenInfo.isExpired()?i(t):that.token},i=function(t){if(e.uptoken)that.token=e.uptoken;else if(e.uptoken_url){logger.debug("get uptoken from: ",that.uptoken_url);var r=that.createAjax();if(r.open("GET",that.uptoken_url+"?"+ +new Date,!1),r.send(),200===r.status){var o=that.parseJSON(r.responseText);that.token=o.uptoken;var i=that.token.split(":"),a=that.parseJSON(that.URLSafeBase64Decode(i[2]));that.tokenMap||(that.tokenMap={});var u=function(e){return Math.ceil(e.getTime()/1e3)},s=u(new Date(r.getResponseHeader("date"))),c=u(new Date);that.tokenInfo={serverDelay:c-s,deadline:a.deadline,isExpired:function(){return this.deadline-u(new Date)+this.serverDelay<600}},logger.debug("get new uptoken: ",that.token),logger.debug("get token info: ",that.tokenInfo)}else logger.error("get uptoken error: ",r.responseText)}else e.uptoken_func?(logger.debug("get uptoken from uptoken_func"),that.token=e.uptoken_func(t),logger.debug("get new uptoken: ",that.token)):logger.error("one of [uptoken, uptoken_url, uptoken_func] settings in options is required!");return that.token&&n(that.token),that.token},a=function(t,r,n){var o="",i=!1;if(!e.save_key)if(i=t.getOption&&t.getOption("unique_names"),i=i||t.settings&&t.settings.unique_names){var a=that.getFileExtension(r.name);o=a?r.id+"."+a:r.id}else o="function"==typeof n?n(t,r):r.name;return o};if(e.log_level&&(logger.level=e.log_level),!e.domain)throw"domain setting in options is required!";if(!e.browse_button)throw"browse_button setting in options is required!";if(!e.uptoken&&!e.uptoken_url&&!e.uptoken_func)throw"one of [uptoken, uptoken_url, uptoken_func] settings in options is required!";logger.debug("init uploader start"),logger.debug("environment: ",moxie.core.utils.Env),logger.debug("userAgent: ",navigator.userAgent);var u={},s=e.init&&e.init.Error,c=e.init&&e.init.FileUploaded;e.init.Error=function(){},e.init.FileUploaded=function(){},that.uptoken_url=e.uptoken_url,that.token="",that.key_handler="function"==typeof e.init.Key?e.init.Key:"",this.domain=e.domain;var f="",l={isResumeUpload:!1,resumeFilesize:0,startTime:"",currentTime:""};!function(){var t,r,n=that.detectIEVersion(),o="Safari"===moxie.core.utils.Env.browser&&moxie.core.utils.Env.version<=5&&"Windows"===moxie.core.utils.Env.os&&"7"===moxie.core.utils.Env.osVersion||"Safari"===moxie.core.utils.Env.browser&&"iOS"===moxie.core.utils.Env.os&&"7"===moxie.core.utils.Env.osVersion;n&&n<9&&e.chunk_size&&e.runtimes.indexOf("flash")>=0?e.chunk_size=0:o?e.chunk_size=0:(t=20,r=4<<t,plupload.parseSize(e.chunk_size)>r&&(e.chunk_size=r))}(),logger.debug("invoke reset_chunk_size()"),logger.debug("op.chunk_size: ",e.chunk_size);var p={url:qiniuUploadUrl,multipart_params:{token:""}},d=that.detectIEVersion();d&&d<=9&&(p.multipart_params.accept="text/plain; charset=utf-8",logger.debug("add accept text/plain in multipart params")),plupload.extend(u,e,p),logger.debug("option: ",u);var g=new plupload.Uploader(u);logger.debug("new plupload.Uploader(option)"),g.bind("Init",function(t,r){logger.debug("Init event activated"),e.get_new_uptoken||i(null)}),logger.debug("bind Init event"),g.bind("FilesAdded",function(e,t){logger.debug("FilesAdded event activated");var r=e.getOption&&e.getOption("auto_start");r=r||e.settings&&e.settings.auto_start,logger.debug("auto_start: ",r),logger.debug("files: ",t);if(function(){return"ios"===moxie.core.utils.Env.OS.toLowerCase()}())for(var n=0;n<t.length;n++){var o=t[n],i=that.getFileExtension(o.name);o.name=o.id+"."+i}r&&setTimeout(function(){e.start(),logger.debug("invoke up.start()")},0),e.refresh()}),logger.debug("bind FilesAdded event"),g.bind("BeforeUpload",function(t,r){logger.debug("BeforeUpload event activated"),r.speed=r.speed||0,f="",e.get_new_uptoken&&i(r);var n=function(t,r,n){l.startTime=(new Date).getTime();var o;o=e.save_key?{token:that.token}:{key:a(t,r,n),token:that.token};var i=that.detectIEVersion();i&&i<=9&&(o.accept="text/plain; charset=utf-8",logger.debug("add accept text/plain in multipart params")),logger.debug("directUpload multipart_params_obj: ",o);var s=e.x_vars;if(void 0!==s&&"object"===(void 0===s?"undefined":(0,_typeof3.default)(s)))for(var c in s)s.hasOwnProperty(c)&&("function"==typeof s[c]?o["x:"+c]=s[c](t,r):"object"!==(0,_typeof3.default)(s[c])&&(o["x:"+c]=s[c]));t.setOption({url:qiniuUploadUrl,multipart:!0,chunk_size:u()?e.max_file_size:void 0,multipart_params:o})},u=function(){var e=navigator.userAgent.toLowerCase();return!(!e.match(/MicroMessenger/i)&&"QQBrowser"!==moxie.core.utils.Env.browser&&!e.match(/V1_AND_SQ/i)||"android"!==moxie.core.utils.Env.OS.toLowerCase())},s=t.getOption&&t.getOption("chunk_size");if(s=s||t.settings&&t.settings.chunk_size,logger.debug("uploader.runtime: ",g.runtime),logger.debug("chunk_size: ",s),"html5"!==g.runtime&&"flash"!==g.runtime||!s)logger.debug("directUpload because uploader.runtime !== 'html5' || uploader.runtime !== 'flash' || !chunk_size"),n(t,r,that.key_handler);else if(r.size<s||u())logger.debug("directUpload because file.size < chunk_size || is_android_weixin_or_qq()"),n(t,r,that.key_handler);else{var c=localStorage.getItem(r.name),p=s;if(c){c=that.parseJSON(c);var d=(new Date).getTime(),h=c.time||0;d-h<864e5&&100!==c.percent&&r.size===c.total?(r.percent=c.percent,r.loaded=c.offset,f=c.ctx,l.isResumeUpload=!0,l.resumeFilesize=c.offset,c.offset+p>r.size&&(p=r.size-c.offset)):localStorage.removeItem(r.name)}l.startTime=(new Date).getTime();var v={},m=that.detectIEVersion();m&&m<=9&&(v.accept="text/plain; charset=utf-8",logger.debug("add accept text/plain in multipart params")),t.setOption({url:qiniuUploadUrl+"/mkblk/"+p,multipart:!1,chunk_size:s,required_features:"chunks",headers:{Authorization:"UpToken "+o(r)},multipart_params:v})}}),logger.debug("bind BeforeUpload event"),g.bind("UploadProgress",function(e,t){logger.trace("UploadProgress event activated"),l.currentTime=(new Date).getTime();var r=l.currentTime-l.startTime,n=t.loaded||0;l.isResumeUpload&&(n=t.loaded-l.resumeFilesize),t.speed=(n/r*1e3).toFixed(0)||0}),logger.debug("bind UploadProgress event"),g.bind("ChunkUploaded",function(e,t,r){logger.debug("ChunkUploaded event activated"),logger.debug("ChunkUploaded file: ",t),logger.debug("ChunkUploaded info: ",r);var n=that.parseJSON(r.response);logger.debug("ChunkUploaded res: ",n),f=f?f+","+n.ctx:n.ctx;var i=r.total-r.offset,a=e.getOption&&e.getOption("chunk_size");a=a||e.settings&&e.settings.chunk_size,i<a&&(e.setOption({url:qiniuUploadUrl+"/mkblk/"+i}),logger.debug("up.setOption url: ",qiniuUploadUrl+"/mkblk/"+i)),e.setOption({headers:{Authorization:"UpToken "+o(t)}}),localStorage.setItem(t.name,that.stringifyJSON({ctx:f,percent:t.percent,total:r.total,offset:r.offset,time:(new Date).getTime()}))}),logger.debug("bind ChunkUploaded event");var h=qiniuUploadUrls.length,v=function(e){return h-- >0?(setTimeout(function(){that.resetUploadUrl(),e.status=plupload.QUEUED,g.stop(),g.start()},0),!0):(h=qiniuUploadUrls.length,!1)};return g.bind("Error",function(e){return function(t,r){logger.error("Error event activated"),logger.error("err: ",r);var n="",o=r.file;if(o){switch(r.code){case plupload.FAILED:n="上传失败。请稍后再试。";break;case plupload.FILE_SIZE_ERROR:var i=t.getOption&&t.getOption("max_file_size");i=i||t.settings&&t.settings.max_file_size,n="浏览器最大可上传"+i+"。更大文件请使用命令行工具。";break;case plupload.FILE_EXTENSION_ERROR:n="文件验证失败。请稍后重试。";break;case plupload.HTTP_ERROR:if(""===r.response){if(n=r.message||"未知网络错误。",!v(o))return;break}var a=that.parseJSON(r.response),u=a.error;switch(r.status){case 400:n="请求报文格式错误。";break;case 401:n="客户端认证授权失败。请重试或提交反馈。";break;case 405:n="客户端请求错误。请重试或提交反馈。";break;case 579:n="资源上传成功，但回调失败。";break;case 599:if(n="网络连接异常。请重试或提交反馈。",!v(o))return;break;case 614:n="文件已存在。";try{a=that.parseJSON(a.error),u=a.error||"file exists"}catch(e){u=a.error||"file exists"}break;case 631:n="指定空间不存在。";break;case 701:n="上传数据块校验出错。请重试或提交反馈。";break;default:if(n="未知错误。",!v(o))return}n=n+"("+r.status+"："+u+")";break;case plupload.SECURITY_ERROR:n="安全配置错误。请联系网站管理员。";break;case plupload.GENERIC_ERROR:n="上传失败。请稍后再试。";break;case plupload.IO_ERROR:n="上传失败。请稍后再试。";break;case plupload.INIT_ERROR:n="网站配置错误。请联系网站管理员。",g.destroy();break;default:if(n=r.message+r.details,!v(o))return}e&&e(t,r,n)}t.refresh()}}(s)),logger.debug("bind Error event"),g.bind("FileUploaded",function(t){return function(r,n,o){logger.debug("FileUploaded event activated"),logger.debug("FileUploaded file: ",n),logger.debug("FileUploaded info: ",o);var i=function(r,n,o){if(logger.debug("FileUploaded last step:",o),e.downtoken_url){var i=that.createAjax();i.open("POST",e.downtoken_url,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){var e;try{e=that.parseJSON(i.responseText)}catch(e){throw"invalid json format"}var a={};plupload.extend(a,that.parseJSON(o.response),e),t&&t(r,n,that.stringifyJSON(a))}else g.trigger("Error",{status:i.status,response:i.responseText,file:n,code:plupload.HTTP_ERROR})},i.send("key="+that.parseJSON(o.response).key+"&domain="+e.domain)}else t&&t(r,n,o)},u=that.parseJSON(o.response);if(f=f?f:u.ctx,logger.debug("ctx: ",f),f){var s="";logger.debug("save_key: ",e.save_key),e.save_key||(s=a(r,n,that.key_handler),s=s?"/key/"+that.URLSafeBase64Encode(s):"");var c="/fname/"+that.URLSafeBase64Encode(n.name);logger.debug("op.x_vars: ",e.x_vars);var l=e.x_vars,p="",d="";if(void 0!==l&&"object"===(void 0===l?"undefined":(0,_typeof3.default)(l)))for(var h in l)l.hasOwnProperty(h)&&("function"==typeof l[h]?p=that.URLSafeBase64Encode(l[h](r,n)):"object"!==(0,_typeof3.default)(l[h])&&(p=that.URLSafeBase64Encode(l[h])),d+="/x:"+h+"/"+p);var v,m=qiniuUploadUrl+"/mkfile/"+n.size+s+c+d,y=that.detectIEVersion();y&&y<=9?(v=new moxie.xhr.XMLHttpRequest,moxie.core.utils.Env.swf_url=e.flash_swf_url):v=that.createAjax(),v.open("POST",m,!0),v.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),v.setRequestHeader("Authorization","UpToken "+that.token);var b=function(){if(logger.debug("ajax.readyState: ",v.readyState),4===v.readyState){localStorage.removeItem(n.name);var e;200===v.status?(e={status:v.status,response:v.responseText,responseHeaders:v.getAllResponseHeaders()},logger.debug("mkfile is success: ",e),i(r,n,e)):(e={status:v.status,response:v.responseText,file:n,code:-200,responseHeaders:v.getAllResponseHeaders()},logger.debug("mkfile is error: ",e),g.trigger("Error",e))}};y&&y<=9?v.bind("readystatechange",b):v.onreadystatechange=b,v.send(f),logger.debug("mkfile: ",m)}else i(r,n,o)}}(c)),logger.debug("bind FileUploaded event"),g.init(),logger.debug("invoke uploader.init()"),logger.debug("init uploader end"),g},this.getUrl=function(e){if(!e)return!1;e=encodeURI(e);var t=this.domain;return"/"!==t.slice(t.length-1)&&(t+="/"),t+e},this.imageView2=function(e,t){if(!/^\d$/.test(e.mode))return!1;var r=e.mode,n=e.w||"",o=e.h||"",i=e.q||"",a=e.format||"";if(!n&&!o)return!1;var u="imageView2/"+r;return u+=n?"/w/"+n:"",u+=o?"/h/"+o:"",u+=i?"/q/"+i:"",u+=a?"/format/"+a:"",t&&(u=this.getUrl(t)+"?"+u),u},this.imageMogr2=function(e,t){var r=e["auto-orient"]||"",n=e.thumbnail||"",o=e.strip||"",i=e.gravity||"",a=e.crop||"",u=e.quality||"",s=e.rotate||"",c=e.format||"",f=e.blur||"",l="imageMogr2";return l+=r?"/auto-orient":"",l+=n?"/thumbnail/"+n:"",l+=o?"/strip":"",l+=i?"/gravity/"+i:"",l+=u?"/quality/"+u:"",l+=a?"/crop/"+a:"",l+=s?"/rotate/"+s:"",l+=c?"/format/"+c:"",l+=f?"/blur/"+f:"",t&&(l=this.getUrl(t)+"?"+l),l},this.watermark=function(e,t){var r=e.mode;if(!r)return!1;var n="watermark/"+r;if(1===r){var o=e.image||"";if(!o)return!1;n+=o?"/image/"+this.URLSafeBase64Encode(o):""}else{if(2!==r)return!1;var i=e.text?e.text:"",a=e.font?e.font:"",u=e.fontsize?e.fontsize:"",s=e.fill?e.fill:"";if(!i)return!1;n+=i?"/text/"+this.URLSafeBase64Encode(i):"",n+=a?"/font/"+this.URLSafeBase64Encode(a):"",n+=u?"/fontsize/"+u:"",n+=s?"/fill/"+this.URLSafeBase64Encode(s):""}var c=e.dissolve||"",f=e.gravity||"",l=e.dx||"",p=e.dy||"";return n+=c?"/dissolve/"+c:"",n+=f?"/gravity/"+f:"",n+=l?"/dx/"+l:"",n+=p?"/dy/"+p:"",t&&(n=this.getUrl(t)+"?"+n),n},this.imageInfo=function(e){if(!e)return!1;var t,r=this.getUrl(e)+"?imageInfo",n=this.createAjax(),o=this;return n.open("GET",r,!1),n.onreadystatechange=function(){4===n.readyState&&200===n.status&&(t=o.parseJSON(n.responseText))},n.send(),t},this.exif=function(e){if(!e)return!1;var t,r=this.getUrl(e)+"?exif",n=this.createAjax(),o=this;return n.open("GET",r,!1),n.onreadystatechange=function(){4===n.readyState&&200===n.status&&(t=o.parseJSON(n.responseText))},n.send(),t},this.get=function(e,t){return!(!t||!e)&&("exif"===e?this.exif(t):"imageInfo"===e&&this.imageInfo(t))},this.pipeline=function(e,t){var r,n,o="[object Array]"===Object.prototype.toString.call(e),i="";if(o){for(var a=0,u=e.length;a<u;a++){if(r=e[a],!r.fop)return!1;switch(r.fop){case"watermark":i+=this.watermark(r)+"|";break;case"imageView2":i+=this.imageView2(r)+"|";break;case"imageMogr2":i+=this.imageMogr2(r)+"|";break;default:n=!0}if(n)return!1}if(t){i=this.getUrl(t)+"?"+i;var s=i.length;"|"===i.slice(s-1)&&(i=i.slice(0,s-1))}return i}return!1}}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof2=__webpack_require__(39),_typeof3=_interopRequireDefault(_typeof2),_pluploadEs=__webpack_require__(69),_pluploadEs2=_interopRequireDefault(_pluploadEs),plupload=_pluploadEs2.default.plupload,moxie=_pluploadEs2.default.moxie;window.localStorage||(window.localStorage={setItem:function(e,t){createCookie(e,t,30)},getItem:function(e){return readCookie(e)},removeItem:function(e){createCookie(e,"",-1)}});var Qiniu=new QiniuJsSDK;exports.default={Qiniu:Qiniu,QiniuJsSDK:QiniuJsSDK}},function(e,t,r){e.exports={default:r(40),__esModule:!0}},function(e,t,r){e.exports={default:r(41),__esModule:!0}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=r(38),i=n(o),a=r(37),u=n(a),s="function"==typeof u.default&&"symbol"==typeof i.default?function(e){return typeof e}:function(e){return e&&"function"==typeof u.default&&e.constructor===u.default&&e!==u.default.prototype?"symbol":typeof e};t.default="function"==typeof u.default&&"symbol"===s(i.default)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof u.default&&e.constructor===u.default&&e!==u.default.prototype?"symbol":void 0===e?"undefined":s(e)}},function(e,t,r){r(65),r(63),r(66),r(67),e.exports=r(13).Symbol},function(e,t,r){r(64),r(68),e.exports=r(25).f("iterator")},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(){}},function(e,t,r){var n=r(2),o=r(60),i=r(59);e.exports=function(e){return function(t,r,a){var u,s=n(t),c=o(s.length),f=i(a,c);if(e&&r!=r){for(;c>f;)if((u=s[f++])!=u)return!0}else for(;c>f;f++)if((e||f in s)&&s[f]===r)return e||f||0;return!e&&-1}}},function(e,t,r){var n=r(42);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){var n=r(10),o=r(33),i=r(18);e.exports=function(e){var t=n(e),r=o.f;if(r)for(var a,u=r(e),s=i.f,c=0;u.length>c;)s.call(e,a=u[c++])&&t.push(a);return t}},function(e,t,r){e.exports=r(0).document&&document.documentElement},function(e,t,r){var n=r(26);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t,r){var n=r(26);e.exports=Array.isArray||function(e){return"Array"==n(e)}},function(e,t,r){"use strict";var n=r(31),o=r(11),i=r(19),a={};r(4)(a,r(6)("iterator"),function(){return this}),e.exports=function(e,t,r){e.prototype=n(a,{next:o(1,r)}),i(e,t+" Iterator")}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){var n=r(10),o=r(2);e.exports=function(e,t){for(var r,i=o(e),a=n(i),u=a.length,s=0;u>s;)if(i[r=a[s++]]===t)return r}},function(e,t,r){var n=r(12)("meta"),o=r(9),i=r(1),a=r(5).f,u=0,s=Object.isExtensible||function(){return!0},c=!r(8)(function(){return s(Object.preventExtensions({}))}),f=function(e){a(e,n,{value:{i:"O"+ ++u,w:{}}})},l=function(e,t){if(!o(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,n)){if(!s(e))return"F";if(!t)return"E";f(e)}return e[n].i},p=function(e,t){if(!i(e,n)){if(!s(e))return!0;if(!t)return!1;f(e)}return e[n].w},d=function(e){return c&&g.NEED&&s(e)&&!i(e,n)&&f(e),e},g=e.exports={KEY:n,NEED:!1,fastKey:l,getWeak:p,onFreeze:d}},function(e,t,r){var n=r(5),o=r(7),i=r(10);e.exports=r(3)?Object.defineProperties:function(e,t){o(e);for(var r,a=i(t),u=a.length,s=0;u>s;)n.f(e,r=a[s++],t[r]);return e}},function(e,t,r){var n=r(18),o=r(11),i=r(2),a=r(23),u=r(1),s=r(29),c=Object.getOwnPropertyDescriptor;t.f=r(3)?c:function(e,t){if(e=i(e),t=a(t,!0),s)try{return c(e,t)}catch(e){}if(u(e,t))return o(!n.f.call(e,t),e[t])}},function(e,t,r){var n=r(2),o=r(32).f,i={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],u=function(e){try{return o(e)}catch(e){return a.slice()}};e.exports.f=function(e){return a&&"[object Window]"==i.call(e)?u(e):o(n(e))}},function(e,t,r){var n=r(1),o=r(61),i=r(20)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),n(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,r){var n=r(22),o=r(14);e.exports=function(e){return function(t,r){var i,a,u=String(o(t)),s=n(r),c=u.length;return s<0||s>=c?e?"":void 0:(i=u.charCodeAt(s),i<55296||i>56319||s+1===c||(a=u.charCodeAt(s+1))<56320||a>57343?e?u.charAt(s):i:e?u.slice(s,s+2):a-56320+(i-55296<<10)+65536)}}},function(e,t,r){var n=r(22),o=Math.max,i=Math.min;e.exports=function(e,t){return e=n(e),e<0?o(e+t,0):i(e,t)}},function(e,t,r){var n=r(22),o=Math.min;e.exports=function(e){return e>0?o(n(e),9007199254740991):0}},function(e,t,r){var n=r(14);e.exports=function(e){return Object(n(e))}},function(e,t,r){"use strict";var n=r(43),o=r(51),i=r(16),a=r(2);e.exports=r(30)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,o(1)):"keys"==t?o(0,r):"values"==t?o(0,e[r]):o(0,[r,e[r]])},"values"),i.Arguments=i.Array,n("keys"),n("values"),n("entries")},function(e,t){},function(e,t,r){"use strict";var n=r(58)(!0);r(30)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},function(e,t,r){"use strict";var n=r(0),o=r(1),i=r(3),a=r(28),u=r(35),s=r(53).KEY,c=r(8),f=r(21),l=r(19),p=r(12),d=r(6),g=r(25),h=r(24),v=r(52),m=r(46),y=r(49),b=r(7),_=r(2),x=r(23),k=r(11),w=r(31),O=r(56),S=r(55),E=r(5),U=r(10),T=S.f,j=E.f,R=O.f,A=n.Symbol,q=n.JSON,I=q&&q.stringify,N=d("_hidden"),C=d("toPrimitive"),P={}.propertyIsEnumerable,M=f("symbol-registry"),F=f("symbols"),L=f("op-symbols"),z=Object.prototype,J="function"==typeof A,D=n.QObject,B=!D||!D.prototype||!D.prototype.findChild,H=i&&c(function(){return 7!=w(j({},"a",{get:function(){return j(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=T(z,t);n&&delete z[t],j(e,t,r),n&&e!==z&&j(z,t,n)}:j,V=function(e){var t=F[e]=w(A.prototype);return t._k=e,t},Q=J&&"symbol"==typeof A.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof A},K=function(e,t,r){return e===z&&K(L,t,r),b(e),t=x(t,!0),b(r),o(F,t)?(r.enumerable?(o(e,N)&&e[N][t]&&(e[N][t]=!1),r=w(r,{enumerable:k(0,!1)})):(o(e,N)||j(e,N,k(1,{})),e[N][t]=!0),H(e,t,r)):j(e,t,r)},G=function(e,t){b(e);for(var r,n=m(t=_(t)),o=0,i=n.length;i>o;)K(e,r=n[o++],t[r]);return e},W=function(e,t){return void 0===t?w(e):G(w(e),t)},X=function(e){var t=P.call(this,e=x(e,!0));return!(this===z&&o(F,e)&&!o(L,e))&&(!(t||!o(this,e)||!o(F,e)||o(this,N)&&this[N][e])||t)},Y=function(e,t){if(e=_(e),t=x(t,!0),e!==z||!o(F,t)||o(L,t)){var r=T(e,t);return!r||!o(F,t)||o(e,N)&&e[N][t]||(r.enumerable=!0),r}},$=function(e){for(var t,r=R(_(e)),n=[],i=0;r.length>i;)o(F,t=r[i++])||t==N||t==s||n.push(t);return n},Z=function(e){for(var t,r=e===z,n=R(r?L:_(e)),i=[],a=0;n.length>a;)!o(F,t=n[a++])||r&&!o(z,t)||i.push(F[t]);return i};J||(A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var e=p(arguments.length>0?arguments[0]:void 0),t=function(r){this===z&&t.call(L,r),o(this,N)&&o(this[N],e)&&(this[N][e]=!1),H(this,e,k(1,r))};return i&&B&&H(z,e,{configurable:!0,set:t}),V(e)},u(A.prototype,"toString",function(){return this._k}),S.f=Y,E.f=K,r(32).f=O.f=$,r(18).f=X,r(33).f=Z,i&&!r(17)&&u(z,"propertyIsEnumerable",X,!0),g.f=function(e){return V(d(e))}),a(a.G+a.W+a.F*!J,{Symbol:A});for(var ee="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),te=0;ee.length>te;)d(ee[te++]);for(var ee=U(d.store),te=0;ee.length>te;)h(ee[te++]);a(a.S+a.F*!J,"Symbol",{for:function(e){return o(M,e+="")?M[e]:M[e]=A(e)},keyFor:function(e){if(Q(e))return v(M,e);throw TypeError(e+" is not a symbol!")},useSetter:function(){B=!0},useSimple:function(){B=!1}}),a(a.S+a.F*!J,"Object",{create:W,defineProperty:K,defineProperties:G,getOwnPropertyDescriptor:Y,getOwnPropertyNames:$,getOwnPropertySymbols:Z}),q&&a(a.S+a.F*(!J||c(function(){var e=A();return"[null]"!=I([e])||"{}"!=I({a:e})||"{}"!=I(Object(e))})),"JSON",{stringify:function(e){if(void 0!==e&&!Q(e)){for(var t,r,n=[e],o=1;arguments.length>o;)n.push(arguments[o++]);return t=n[1],"function"==typeof t&&(r=t),!r&&y(t)||(t=function(e,t){if(r&&(t=r.call(this,e,t)),!Q(t))return t}),n[1]=t,I.apply(q,n)}}}),A.prototype[C]||r(4)(A.prototype,C,A.prototype.valueOf),l(A,"Symbol"),l(Math,"Math",!0),l(n.JSON,"JSON",!0)},function(e,t,r){r(24)("asyncIterator")},function(e,t,r){r(24)("observable")},function(e,t,r){r(62);for(var n=r(0),o=r(4),i=r(16),a=r(6)("toStringTag"),u=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],s=0;s<5;s++){var c=u[s],f=n[c],l=f&&f.prototype;l&&!l[a]&&o(l,a,c),i[c]=i.Array}},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_69__},function(e,t,r){e.exports=r(36)}])});